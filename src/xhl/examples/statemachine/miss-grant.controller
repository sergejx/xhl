; Miss Grant's Controller
;
; Based on example by Martin Fowler http://martinfowler.com/dslwip/Intro.html

(events
  doorClosed    "D1CL"
  drawOpened    "D2OP"
  lightOn       "L1ON"
  doorOpened    "D1OP"
  panelClosed   "PNCL")

(resetEvents doorOpened)

(commands
  unlockPanel   "PNUL"
  lockPanel     "PNLK"
  lockDoor      "D1LK"
  unlockDoor    "D1UL")

(state idle
  (actions unlockDoor lockPanel)
  (transitions
    doorClosed active))

(state active
  (transitions
    drawOpened  waitingForLight
    lightOn     waitingForDraw))

(state waitingForLight
  (transitions
    lightOn     unlockedPanel))

(state waitingForDraw
  (transitions
    drawOpened  unlockedPanel))

(state unlockedPanel
  (actions unlockPanel lockDoor)
  (transitions
    panelClosed idle))

